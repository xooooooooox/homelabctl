# Bash completion script for homelabctl
# Generated by radp-bash-framework with custom dynamic completions

# homelabctl completion helper functions

_homelabctl_complete_packages() {
  homelabctl setup list --names-only 2>/dev/null
}

_homelabctl_complete_categories() {
  homelabctl setup list --category-names 2>/dev/null
}

_homelabctl_complete_profiles() {
  homelabctl setup profile list --names-only 2>/dev/null
}

_homelabctl() {
  local cur prev words cword

  # Compatibility mode: if _init_completion doesn't exist, use manual initialization
  if type _init_completion &>/dev/null; then
    _init_completion || return
  else
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD - 1]}"
    words=("${COMP_WORDS[@]}")
    cword="$COMP_CWORD"
  fi

  local i cmd_path=""

  # Build current command path
  for ((i = 1; i < cword; i++)); do
    case "${words[i]}" in
    -*) continue ;;
    *)
      if [[ -z "$cmd_path" ]]; then
        cmd_path="${words[i]}"
      else
        cmd_path="$cmd_path ${words[i]}"
      fi
      ;;
    esac
  done

  # Handle option value completions
  case "$prev" in
  -c | --category)
    if [[ "$cmd_path" == setup* ]]; then
      local completions
      completions=$(_homelabctl_complete_categories)
      COMPREPLY=($(compgen -W "$completions" -- "$cur"))
      return
    fi
    ;;
  esac

  # Command completions
  case "$cmd_path" in
  '')
    COMPREPLY=($(compgen -W "completion setup version vf vg --help --version" -- "$cur"))
    ;;
  'completion')
    COMPREPLY=($(compgen -W "bash zsh --help" -- "$cur"))
    ;;
  'setup')
    COMPREPLY=($(compgen -W "info install list profile --help" -- "$cur"))
    ;;
  'setup info')
    # Argument position completion
    local arg_idx=0
    for ((i = 1; i < cword; i++)); do
      case "${words[i]}" in
      -*) ;;
      *) ((arg_idx++)) ;;
      esac
    done
    case "$arg_idx" in
    2)
      local completions
      completions=$(_homelabctl_complete_packages)
      COMPREPLY=($(compgen -W "$completions" -- "$cur"))
      return
      ;;
    esac
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'setup install')
    # Argument position completion
    local arg_idx=0
    for ((i = 1; i < cword; i++)); do
      case "${words[i]}" in
      -*) ;;
      *) ((arg_idx++)) ;;
      esac
    done
    case "$arg_idx" in
    2)
      local completions
      completions=$(_homelabctl_complete_packages)
      COMPREPLY=($(compgen -W "$completions" -- "$cur"))
      return
      ;;
    esac
    COMPREPLY=($(compgen -W "--help -v --version --dry-run" -- "$cur"))
    ;;
  'setup list')
    COMPREPLY=($(compgen -W "--help -c --category --installed --categories --names-only --category-names" -- "$cur"))
    ;;
  'setup profile')
    COMPREPLY=($(compgen -W "apply list show --help" -- "$cur"))
    ;;
  'setup profile apply')
    # Argument position completion
    local arg_idx=0
    for ((i = 1; i < cword; i++)); do
      case "${words[i]}" in
      -*) ;;
      *) ((arg_idx++)) ;;
      esac
    done
    case "$arg_idx" in
    3)
      local completions
      completions=$(_homelabctl_complete_profiles)
      COMPREPLY=($(compgen -W "$completions" -- "$cur"))
      return
      ;;
    esac
    COMPREPLY=($(compgen -W "--help --dry-run --continue --skip-installed" -- "$cur"))
    ;;
  'setup profile list')
    COMPREPLY=($(compgen -W "--help --names-only" -- "$cur"))
    ;;
  'setup profile show')
    # Argument position completion
    local arg_idx=0
    for ((i = 1; i < cword; i++)); do
      case "${words[i]}" in
      -*) ;;
      *) ((arg_idx++)) ;;
      esac
    done
    case "$arg_idx" in
    3)
      local completions
      completions=$(_homelabctl_complete_profiles)
      COMPREPLY=($(compgen -W "$completions" -- "$cur"))
      return
      ;;
    esac
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'version')
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'vf')
    COMPREPLY=($(compgen -W "dump-config generate info init list template validate version --help" -- "$cur"))
    ;;
  'vf dump-config')
    COMPREPLY=($(compgen -W "--help -e --env -f --format -o --output" -- "$cur"))
    ;;
  'vf generate')
    COMPREPLY=($(compgen -W "--help -e --env" -- "$cur"))
    ;;
  'vf info')
    COMPREPLY=($(compgen -W "--help -e --env -j --json" -- "$cur"))
    ;;
  'vf init')
    COMPREPLY=($(compgen -W "--help -t --template --set" -- "$cur"))
    ;;
  'vf list')
    COMPREPLY=($(compgen -W "--help -e --env -v --verbose -p --provisions -s --synced-folders -t --triggers" -- "$cur"))
    ;;
  'vf template')
    COMPREPLY=($(compgen -W "list show --help" -- "$cur"))
    ;;
  'vf template list')
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'vf template show')
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'vf validate')
    COMPREPLY=($(compgen -W "--help -e --env" -- "$cur"))
    ;;
  'vf version')
    COMPREPLY=($(compgen -W "--help" -- "$cur"))
    ;;
  'vg')
    COMPREPLY=($(compgen -W "--help -e --env -c --config" -- "$cur"))
    ;;
  *)
    COMPREPLY=()
    ;;
  esac
}

complete -F _homelabctl homelabctl
